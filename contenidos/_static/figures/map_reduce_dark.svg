<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 950">
  <rect width="800" height="950" fill="#1e1e1e"/>

  <defs>
    <marker id="arrowhead-dark" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#e0e0e0" />
    </marker>
  </defs>

  <style>
    .label { font-family: Arial; font-size: 14px; text-anchor: middle; dominant-baseline: middle; fill: #e0e0e0; }
    .label-small { font-family: Arial; font-size: 12px; text-anchor: middle; fill: #bbbbbb; }
    .title { font-family: Arial; font-size: 18px; text-anchor: middle; fill: #e0e0e0; font-weight: bold; }
    
    /* Estilos de línea */
    .edge { fill: none; stroke: #e0e0e0; stroke-width: 2; marker-end: url(#arrowhead-dark); }
    .edge-conn { fill: none; stroke: #e0e0e0; stroke-width: 2; }
    
    /* Grupos Contenedores */
    .group-box { fill: #2d3748; stroke: #666666; stroke-width: 2; stroke-dasharray: 5,5; opacity: 0.4; }
    .group-label { font-family: Arial; font-size: 14px; fill: #aaaaaa; font-weight: bold; }

    /* Nodos Dark */
    .box-blue { fill: #2d3748; stroke: #4682b4; stroke-width: 2; }
    .box-green { fill: #2d3748; stroke: #48bb78; stroke-width: 2; }
    .box-orange { fill: #2d3748; stroke: #f6ad55; stroke-width: 2; }
    .box-purple { fill: #2d3748; stroke: #9f7aea; stroke-width: 2; }
  </style>

  <text x="400" y="30" class="title">Proceso de Indexación MapReduce</text>

  <rect x="40" y="60" width="720" height="120" rx="10" class="group-box" />
  <text x="60" y="85" class="group-label" text-anchor="start">Entrada</text>

  <rect x="40" y="200" width="720" height="120" rx="10" class="group-box" />
  <text x="60" y="225" class="group-label" text-anchor="start">Fase Map</text>

  <rect x="200" y="340" width="400" height="200" rx="10" class="group-box" />
  <text x="220" y="365" class="group-label" text-anchor="start">Shuffle &amp; Sort</text>

  <rect x="40" y="560" width="720" height="140" rx="10" class="group-box" />
  <text x="60" y="585" class="group-label" text-anchor="start">Fase Reduce</text>

  <rect x="40" y="720" width="720" height="120" rx="10" class="group-box" />
  <text x="60" y="745" class="group-label" text-anchor="start">Salida</text>

  <g>
    <rect x="80" y="100" width="120" height="50" rx="5" class="box-blue" />
    <text x="140" y="125" class="label">Documento 1</text>
    <rect x="240" y="100" width="120" height="50" rx="5" class="box-blue" />
    <text x="300" y="125" class="label">Documento 2</text>
    <rect x="400" y="100" width="120" height="50" rx="5" class="box-blue" />
    <text x="460" y="125" class="label">Documento 3</text>
    <rect x="560" y="100" width="120" height="50" rx="5" class="box-blue" />
    <text x="620" y="125" class="label">Documento N</text>

    <rect x="80" y="240" width="120" height="50" rx="5" class="box-green" />
    <text x="140" y="265" class="label">Mapper 1</text>
    <rect x="240" y="240" width="120" height="50" rx="5" class="box-green" />
    <text x="300" y="265" class="label">Mapper 2</text>
    <rect x="400" y="240" width="120" height="50" rx="5" class="box-green" />
    <text x="460" y="265" class="label">Mapper 3</text>
    <rect x="560" y="240" width="120" height="50" rx="5" class="box-green" />
    <text x="620" y="265" class="label">Mapper N</text>

    <rect x="300" y="380" width="200" height="50" rx="5" class="box-orange" />
    <text x="400" y="405" class="label">Agrupa por término</text>
    <rect x="300" y="460" width="200" height="50" rx="5" class="box-orange" />
    <text x="400" y="485" class="label">Ordena postings</text>

    <rect x="130" y="600" width="140" height="60" rx="5" class="box-purple" />
    <text x="200" y="620" class="label">Reducer 1</text>
    <text x="200" y="640" class="label-small">términos a-f</text>

    <rect x="330" y="600" width="140" height="60" rx="5" class="box-purple" />
    <text x="400" y="620" class="label">Reducer 2</text>
    <text x="400" y="640" class="label-small">términos g-m</text>

    <rect x="530" y="600" width="140" height="60" rx="5" class="box-purple" />
    <text x="600" y="620" class="label">Reducer 3</text>
    <text x="600" y="640" class="label-small">términos n-z</text>

    <rect x="130" y="760" width="140" height="50" rx="5" class="box-blue" />
    <text x="200" y="785" class="label">Índice parcial 1</text>
    <rect x="330" y="760" width="140" height="50" rx="5" class="box-blue" />
    <text x="400" y="785" class="label">Índice parcial 2</text>
    <rect x="530" y="760" width="140" height="50" rx="5" class="box-blue" />
    <text x="600" y="785" class="label">Índice parcial 3</text>
  </g>

  <g>
    <path d="M 140,150 V 240" class="edge" />
    <path d="M 300,150 V 240" class="edge" />
    <path d="M 460,150 V 240" class="edge" />
    <path d="M 620,150 V 240" class="edge" />

    <path d="M 140,290 V 350 H 400" class="edge-conn" />
    <path d="M 300,290 V 350 H 400" class="edge-conn" />
    <path d="M 460,290 V 350 H 400" class="edge-conn" />
    <path d="M 620,290 V 350 H 400" class="edge-conn" />
    
    <path d="M 400,350 V 380" class="edge" />

    <path d="M 400,430 V 460" class="edge" />

    <path d="M 400,510 V 525 H 200 V 600" class="edge" />
    <path d="M 400,510 V 600" class="edge" />
    <path d="M 400,510 V 525 H 600 V 600" class="edge" />

    <path d="M 200,660 V 760" class="edge" />
    <path d="M 400,660 V 760" class="edge" />
    <path d="M 600,660 V 760" class="edge" />

    <rect x="600" y="325" width="90" height="20" fill="#1e1e1e" />
    <text x="645" y="340" class="label-small">(término, doc_id)</text>
    
    <rect x="240" y="520" width="70" height="15" fill="#1e1e1e" />
    <text x="275" y="532" class="label-small">término a-f</text>
    
    <rect x="410" y="520" width="70" height="15" fill="#1e1e1e" />
    <text x="445" y="532" class="label-small">término g-m</text>
    
    <rect x="540" y="520" width="70" height="15" fill="#1e1e1e" />
    <text x="575" y="532" class="label-small">término n-z</text>
  </g>

</svg>